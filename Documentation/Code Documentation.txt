Code Documentation - 

PCE - APE to WAV.bat 

@echo off
REM PC Engine CD ROMs can come with .cue/.iso/.ape files instead of the .wav files expected in the .cue filesR
REM This reads the PC Engine CD folder, scans through all the folders, converting the .ape files to .wav
REM Later versions of this will also delete the .ape files, though it will give a choice.


:: clear the %p% variable if it is set anywhere
:: testing note: never try to use %prompt%. It apparently is a special variable.
set version=0.1a
set "p="


:: SETLOCAL ENABLEDELAYEDEXPANSION

:: This line sets the variable of where the folder with the ROMs are. 
:: set pcenginecdpath="F:\folder"
:: Runs FOR loop through every file and sub-folder, looking for .ape file.
:: Converts the .ape file to .wav, leaving the .ape file (for now). 
:: for /r %pcenginecdpath% %%i in (*.ape) do ffmpeg.exe -y -i "%%i" "%%~ni.wav"

:: NOTE - Later versions give option to delete either individual files, or all .ape files after script run.

::again 
::   echo If the question is long or requires an explanation,
::   echo use echo commands to display text before the question.
::   set /p answer=Ask the question here (Y/N)?
::   if /i "%answer:~,1%" EQU "Y" command to execute for Yes
::   if /i "%answer:~,1%" EQU "N" command to execute for No
::   echo Please type Y for Yes or N for No
::   goto again

:main 
   cls
   echo ---------------------------------------------
   echo --           retro-tools v.%version%        --
   echo --       PC Engine / TurboGraphix 16       --
   echo --             .APE ^=^> .WAV                --
   echo --               Converter                 --
   set /p p=-- ROM location[%1]: 

   if "%p%" == "" ( 
	set roms=%1 
   ) else ( 
	set roms=%p% 
   )

echo %roms%

   goto dothedancefandango  
   
:: echo %roms%   
:: set /p roms=
:: set /p rpie =-- Retropie address/hostname[%2]:

:dothedancefandango 

:: for recursively traversing the %roms% directory, each %i matched to .ape,
:: run ffmpeg.exe forcing overwrite (-y), using the %i for the input (-i),
:: exporting to the same full directory it is in (%~dpi) and track name (%ni)
:: renaming the output to .wav. 

for /r %roms% %%i in (*.ape) do ffmpeg.exe -y -i "%%i" "%%~dpi%%~ni.wav"

:: go back to the start of the pro

goto main
